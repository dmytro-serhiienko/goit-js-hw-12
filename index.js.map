{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst loaderClass = document.querySelector('.loader');\nconst galleryClass = document.querySelector('.gallery');\nconst showMoreBtnClass = document.querySelector('.show-more-btn');\n\nlet gallery = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  preloading: false,\n});\n\nexport function showLoader() {\n  loaderClass.classList.remove('hidden');\n}\n\nexport function removeLoader() {\n  loaderClass.classList.add('hidden');\n}\n\nexport function clearGallery() {\n  galleryClass.innerHTML = '';\n}\n\nexport function createGallery(images) {\n  const markup = images\n    .map(\n      el => `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${el.largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${el.webformatURL}\"\n          alt=\"${el.tags}\"\n          width=\"360\"\n          height=\"200\"\n        />\n      </a>\n      <div class=\"card\">\n        <ul>\n          <li>\n            <p class=\"title\">Likes</p>\n            <p class=\"subtitle\">${el.likes}</p>\n          </li>\n          <li>\n            <p class=\"title\">Views</p>\n            <p class=\"subtitle\">${el.views}</p>\n          </li>\n          <li>\n            <p class=\"title\">Comments</p>\n            <p class=\"subtitle\">${el.comments}</p>\n          </li>\n          <li>\n            <p class=\"title\">Downloads</p>\n            <p class=\"subtitle\">${el.downloads}</p>\n          </li>\n        </ul>\n      </div>\n    </li>`\n    )\n    .join('');\n  galleryClass.innerHTML = markup;\n  gallery.refresh();\n}\n\nexport function appendToGallery(images) {\n  const markup = images\n    .map(\n      el => `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${el.largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${el.webformatURL}\"\n          alt=\"${el.tags}\"\n          width=\"360\"\n          height=\"200\"\n        />\n      </a>\n      <div class=\"card\">\n        <ul>\n          <li>\n            <p class=\"title\">Likes</p>\n            <p class=\"subtitle\">${el.likes}</p>\n          </li>\n          <li>\n            <p class=\"title\">Views</p>\n            <p class=\"subtitle\">${el.views}</p>\n          </li>\n          <li>\n            <p class=\"title\">Comments</p>\n            <p class=\"subtitle\">${el.comments}</p>\n          </li>\n          <li>\n            <p class=\"title\">Downloads</p>\n            <p class=\"subtitle\">${el.downloads}</p>\n          </li>\n        </ul>\n      </div>\n    </li>`\n    )\n    .join('');\n  galleryClass.insertAdjacentHTML('beforeend', markup);\n  gallery.refresh();\n}\n\nexport function removeLoadMoreButton() {\n  showMoreBtnClass.classList.add('hidden');\n}\n\nexport function showLoadMoreButton() {\n  showMoreBtnClass.classList.remove('hidden');\n}\n\nexport function getImageDimensions() {\n  const imageClass = document.querySelector('.gallery-item');\n  const gap = 24;\n  return imageClass.getBoundingClientRect().height + 2 * gap;\n}\n","import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '53639618-7ccf198a06ad48a4b9e98f6f9';\n\nexport async function getImages(query, page = 1, limit = 15) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: limit,\n    page: page,\n  };\n\n  const response = await axios.get(BASE_URL, { params });\n  return { array: response.data.hits, totalHits: response.data.totalHits };\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport {\n  clearGallery,\n  createGallery,\n  removeLoader,\n  showLoader,\n  showLoadMoreButton,\n  removeLoadMoreButton,\n  getImageDimensions,\n  appendToGallery,\n} from './js/render-functions';\nimport { getImages } from './js/pixabay-api';\nconst API_KEY = '53125865-ed9f58673896f3ad0b9dfa3df';\n\nconst form = document.querySelector('#search-form');\nconst inputQuery = document.querySelector('.form-input');\nconst showMoreBtn = document.querySelector('.show-more-btn');\n\nlet page = 1;\nconst limit = 15;\nlet currentQuery = '';\nlet totalHits = 0;\nlet allImages = [];\n\nremoveLoader();\nremoveLoadMoreButton();\n\nform.addEventListener('submit', async evt => {\n  evt.preventDefault();\n  removeLoadMoreButton();\n  const query = inputQuery.value.trim();\n  if (!query) {\n    clearGallery();\n    removeLoadMoreButton();\n    iziToast.error({ message: 'Please enter a query', position: 'topRight' });\n    return;\n  }\n\n  showLoader();\n\n  try {\n    currentQuery = query;\n    page = 1;\n    allImages = [];\n    clearGallery();\n\n    const { array: images, totalHits: hits } = await getImages(\n      query,\n      page,\n      limit\n    );\n    if (images.length === 0) {\n      removeLoader();\n      removeLoadMoreButton();\n      iziToast.error({\n        message: 'No images were found. Try another query.',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    removeLoader();\n    allImages = images;\n    renderGallery(allImages, true);\n    totalHits = hits;\n\n    if (allImages.length < totalHits) {\n      showLoadMoreButton();\n    } else {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      removeLoadMoreButton();\n    }\n    page += 1;\n  } catch (error) {\n    removeLoader();\n    console.log(error);\n    iziToast.error({\n      message: 'Something went wrong. Try again.',\n      position: 'topRight',\n    });\n  }\n});\n\nshowMoreBtn.addEventListener('click', async evt => {\n  evt.preventDefault();\n  removeLoadMoreButton();\n  showLoader();\n  try {\n    const { array: newImages } = await getImages(currentQuery, page, limit);\n    allImages = allImages.concat(newImages);\n    removeLoader();\n\n    renderGallery(newImages, false);\n\n    setTimeout(() => {\n      let elemHeight = getImageDimensions();\n      window.scrollBy({\n        top: elemHeight * 2,\n        behavior: 'smooth',\n      });\n    }, 100);\n\n    if (allImages.length >= totalHits) {\n      removeLoadMoreButton();\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      showLoadMoreButton();\n    }\n    page += 1;\n  } catch (error) {\n    console.log(error);\n    removeLoader();\n    removeLoadMoreButton();\n    iziToast.error({\n      message: 'Something went wrong. Try again.',\n      position: 'topRight',\n    });\n  }\n});\n\nfunction renderGallery(images, isNewSearch = false) {\n  if (isNewSearch) {\n    createGallery(images);\n  } else {\n    appendToGallery(images);\n  }\n}\n"],"names":["loaderClass","galleryClass","showMoreBtnClass","gallery","SimpleLightbox","showLoader","removeLoader","clearGallery","createGallery","images","markup","el","appendToGallery","removeLoadMoreButton","showLoadMoreButton","getImageDimensions","BASE_URL","API_KEY","getImages","query","page","limit","params","response","axios","form","inputQuery","showMoreBtn","currentQuery","totalHits","allImages","evt","iziToast","hits","renderGallery","error","newImages","elemHeight","isNewSearch"],"mappings":"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"}